<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>PinToken.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">OpenPOS</a> &gt; <a href="index.source.html" class="el_package">com.bizstudio.security.service</a> &gt; <span class="el_source">PinToken.java</span></div><h1>PinToken.java</h1><pre class="source lang-java linenums">/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package com.bizstudio.security.service;

import org.apache.shiro.authc.UsernamePasswordToken;

/**
 *
 * @author ObinnaAsuzu
 */
public class PinToken extends UsernamePasswordToken{

    /**
     * The pin, in char[] format
     */
    private char[] pin;

    /*--------------------------------------------
    |         C O N S T R U C T O R S           |
    ============================================*/

    /**
     * JavaBeans compatible no-arg constructor.
     */
<span class="nc" id="L28">    public PinToken() {</span>
<span class="nc" id="L29">    }</span>

    /**
     * Constructs a new PinToken encapsulating the username and pin submitted
 during an authentication attempt, with a &lt;tt&gt;null&lt;/tt&gt; {@link #getHost() host} and a
     * &lt;tt&gt;rememberMe&lt;/tt&gt; default of &lt;tt&gt;false&lt;/tt&gt;.
     *
     * @param pin the pin character array submitted for authentication
     */
    public PinToken(final char[] pin) {
<span class="nc" id="L39">        this(pin, false, null);</span>
<span class="nc" id="L40">    }</span>

    /**
     * Constructs a new PinToken encapsulating the username and pin submitted
 during an authentication attempt, with a &lt;tt&gt;null&lt;/tt&gt; {@link #getHost() host} and
     * a &lt;tt&gt;rememberMe&lt;/tt&gt; default of &lt;tt&gt;false&lt;/tt&gt;
     * &lt;p/&gt;
     * &lt;p&gt;This is a convenience constructor and maintains the pin internally via a character
 array, i.e. &lt;tt&gt;pin.toCharArray();&lt;/tt&gt;.  Note that storing a pin as a String
 in your code could have possible security implications as noted in the class JavaDoc.&lt;/p&gt;
     *
     * @param pin the pin string submitted for authentication
     */
    public PinToken(final String pin) {
<span class="nc bnc" id="L54" title="All 2 branches missed.">        this(pin != null ? pin.toCharArray() : null, false, null);</span>
<span class="nc" id="L55">    }</span>

    /**
     * Constructs a new PinToken encapsulating the username and pin submitted, the
 inetAddress from where the attempt is occurring, and a default &lt;tt&gt;rememberMe&lt;/tt&gt; value of &lt;tt&gt;false&lt;/tt&gt;
     *
     * @param pin the pin string submitted for authentication
     * @param host     the host name or IP string from where the attempt is occurring
     * @since 0.2
     */
    public PinToken(final char[] pin, final String host) {
<span class="nc" id="L66">        this(pin, false, host);</span>
<span class="nc" id="L67">    }</span>

    /**
     * Constructs a new PinToken encapsulating the username and pin submitted, the
 inetAddress from where the attempt is occurring, and a default &lt;tt&gt;rememberMe&lt;/tt&gt; value of &lt;tt&gt;false&lt;/tt&gt;
     * &lt;p/&gt;
     * &lt;p&gt;This is a convenience constructor and maintains the pin internally via a character
 array, i.e. &lt;tt&gt;pin.toCharArray();&lt;/tt&gt;.  Note that storing a pin as a String
 in your code could have possible security implications as noted in the class JavaDoc.&lt;/p&gt;
     *
     * @param pin the pin string submitted for authentication
     * @param host     the host name or IP string from where the attempt is occurring
     * @since 1.0
     */
    public PinToken(final String pin, final String host) {
<span class="nc bnc" id="L82" title="All 2 branches missed.">        this(pin != null ? pin.toCharArray() : null, false, host);</span>
<span class="nc" id="L83">    }</span>

    /**
     * Constructs a new PinToken encapsulating the username and pin submitted, as well as if the user
 wishes their identity to be remembered across sessions.
     *
     * @param pin   the pin string submitted for authentication
     * @param rememberMe if the user wishes their identity to be remembered across sessions
     * @since 0.9
     */
    public PinToken(final char[] pin, final boolean rememberMe) {
<span class="nc" id="L94">        this(pin, rememberMe, null);</span>
<span class="nc" id="L95">    }</span>

    /**
     * Constructs a new PinToken encapsulating the username and pin submitted, as well as if the user
     * wishes their identity to be remembered across sessions.
     * &lt;p/&gt;
     * &lt;p&gt;This is a convenience constructor and maintains the pin internally via a character
 array, i.e. &lt;tt&gt;pin.toCharArray();&lt;/tt&gt;.  Note that storing a pin as a String
 in your code could have possible security implications as noted in the class JavaDoc.&lt;/p&gt;
     *
     * @param pin   the pin string submitted for authentication
     * @param rememberMe if the user wishes their identity to be remembered across sessions
     * @since 0.9
     */
    public PinToken(final String pin, final boolean rememberMe) {
<span class="nc bnc" id="L110" title="All 2 branches missed.">        this( pin != null ? pin.toCharArray() : null, rememberMe, null);</span>
<span class="nc" id="L111">    }</span>

    /**
     * Constructs a new PinToken encapsulating the username and pin submitted, if the user
 wishes their identity to be remembered across sessions, and the inetAddress from where the attempt is occurring.
     *
     * @param pin   the pin character array submitted for authentication
     * @param rememberMe if the user wishes their identity to be remembered across sessions
     * @param host       the host name or IP string from where the attempt is occurring
     * @since 1.0
     */
    public PinToken( final char[] pin,final boolean rememberMe, final String host) {
<span class="nc" id="L123">        super(null, &quot;&quot;.toCharArray(), rememberMe, host);</span>
<span class="nc" id="L124">        this.pin = pin;</span>
<span class="nc" id="L125">    }</span>
    
    /**
     * Constructs a new PinToken encapsulating the username and pin submitted, if the user
 wishes their identity to be remembered across sessions, and the inetAddress from where the attempt is occurring.
     *
     * @param pin   the pin character array submitted for authentication
     * @param username the username submitted for authentication
     * @param password the password character array submitted for authentication
     * @since 1.0
     */
    public PinToken( final String pin,final String username,final String password) {
<span class="nc" id="L137">        this(pin.toCharArray(), username, password.toCharArray(),false, null);</span>
<span class="nc" id="L138">    }</span>
    
    /**
     * Constructs a new PinToken encapsulating the username and pin submitted, if the user
 wishes their identity to be remembered across sessions, and the inetAddress from where the attempt is occurring.
     *
     * @param pin   the pin character array submitted for authentication
     * @param username the username submitted for authentication
     * @param password the password character array submitted for authentication
     * @param rememberMe if the user wishes their identity to be remembered across sessions
     * @since 1.0
     */
    public PinToken( final String pin,final String username,final String password, final boolean rememberMe) {
<span class="nc" id="L151">        this(pin.toCharArray(), username, password.toCharArray(),rememberMe, null);</span>
<span class="nc" id="L152">    }</span>
    
    /**
     * Constructs a new PinToken encapsulating the username and pin submitted, if the user
 wishes their identity to be remembered across sessions, and the inetAddress from where the attempt is occurring.
     *
     * @param pin   the pin character array submitted for authentication
     * @param username the username submitted for authentication
     * @param password the password character array submitted for authentication
     * @param host       the host name or IP string from where the attempt is occurring
     * @since 1.0
     */
    public PinToken( final String pin,final String username,final String password, final String host) {
<span class="nc" id="L165">        this(pin.toCharArray(), username, password.toCharArray(),false, host);</span>
<span class="nc" id="L166">    }</span>
    
     /**
     * Constructs a new PinToken encapsulating the username and pin submitted, if the user
 wishes their identity to be remembered across sessions, and the inetAddress from where the attempt is occurring.
     *
     * @param pin   the pin character array submitted for authentication
     * @param username the username submitted for authentication
     * @param password the password character array submitted for authentication
     * @param rememberMe if the user wishes their identity to be remembered across sessions
     * @param host       the host name or IP string from where the attempt is occurring
     * @since 1.0
     */
    public PinToken( final String pin,final String username,final String password, final boolean rememberMe, final String host) {
<span class="nc" id="L180">        this(pin.toCharArray(), username, password.toCharArray(),rememberMe, host);</span>
<span class="nc" id="L181">    }</span>
    
     /**
     * Constructs a new PinToken encapsulating the username and pin submitted, if the user
 wishes their identity to be remembered across sessions, and the inetAddress from where the attempt is occurring.
     *
     * @param pin   the pin character array submitted for authentication
     * @param username the username submitted for authentication
     * @param password the password character array submitted for authentication
     * @param rememberMe if the user wishes their identity to be remembered across sessions
     * @param host       the host name or IP string from where the attempt is occurring
     * @since 1.0
     */
    public PinToken( final char[] pin,final String username,final char[] password, final boolean rememberMe, final String host) {
<span class="nc" id="L195">        super(username, password, host);</span>
<span class="nc" id="L196">        this.pin = pin;</span>
<span class="nc" id="L197">    }</span>


    /**
     * Constructs a new PinToken encapsulating the username and pin submitted, if the user
     * wishes their identity to be remembered across sessions, and the inetAddress from where the attempt is occurring.
     * &lt;p/&gt;
     * &lt;p&gt;This is a convenience constructor and maintains the pin internally via a character
 array, i.e. &lt;tt&gt;pin.toCharArray();&lt;/tt&gt;.  Note that storing a pin as a String
 in your code could have possible security implications as noted in the class JavaDoc.&lt;/p&gt;
     *
     * @param pin   the pin string submitted for authentication
     * @param rememberMe if the user wishes their identity to be remembered across sessions
     * @param host       the host name or IP string from where the attempt is occurring
     * @since 1.0
     */
    public PinToken( final String pin, final boolean rememberMe, final String host) {
<span class="nc bnc" id="L214" title="All 2 branches missed.">        this(pin != null ? pin.toCharArray() : null, rememberMe, host);</span>
<span class="nc" id="L215">    }</span>

    /*--------------------------------------------
    |  A C C E S S O R S / M O D I F I E R S    |
    ============================================*/

   


    /**
     * Returns the pin submitted during an authentication attempt as a character array.
     *
     * @return the pin submitted during an authentication attempt as a character array.
     */
    public char[] getPin() {
<span class="nc" id="L230">        return pin;</span>
    }

    /**
     * Sets the pin for submission during an authentication attempt.
     *
     * @param pin the pin to be used for submission during an authentication attempt.
     */
    public void setPin(char[] pin) {
<span class="nc" id="L239">        this.pin = pin;</span>
<span class="nc" id="L240">    }</span>

    /**
     * Simply returns {@link #getUsername() getUsername()}.
     *
     * @return the {@link #getUsername() username}.
     * @see org.apache.shiro.authc.AuthenticationToken#getPrincipal()
     */
    public Object getPrincipal() {
<span class="nc" id="L249">        return null;</span>
    }

    /**
     * Returns the {@link #getPin() pin} char array.
     *
     * @return the {@link #getPin() pin} char array.
     * @see org.apache.shiro.authc.AuthenticationToken#getCredentials()
     */
    public Object getCredentials() {
<span class="nc" id="L259">        return getPin();</span>
    }

    

    /*--------------------------------------------
    |               M E T H O D S               |
    ============================================*/

    /**
     * Clears out (nulls) the username, pin, rememberMe, and inetAddress.  The pin bytes are explicitly set to
     * &lt;tt&gt;0x00&lt;/tt&gt; before nulling to eliminate the possibility of memory access at a later time.
     */
    public void clear() {
<span class="nc" id="L273">        super.clear();</span>

<span class="nc bnc" id="L275" title="All 2 branches missed.">        if (this.pin != null) {</span>
<span class="nc bnc" id="L276" title="All 2 branches missed.">            for (int i = 0; i &lt; pin.length; i++) {</span>
<span class="nc" id="L277">                this.pin[i] = 0x00;</span>
            }
<span class="nc" id="L279">            this.pin = null;</span>
        }

<span class="nc" id="L282">    }</span>

    
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.7.201606060606</span></div></body></html>